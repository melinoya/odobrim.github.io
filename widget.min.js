var _odobrimWidget=function(t,o){"use strict";function e(e){var n=new URLSearchParams;for(var r in e)e.hasOwnProperty(r)&&n.append(r,e[r]);return n.append("location",function(){var e;try{e=t.top.location.href}catch(r){if(""!==o.domain){var n=t.location.protocol;e=("data:"===n?"http://":n)+o.domain}else e=t.location.href}return e}()),n.append("token",c),"//"+e.server+"/widget/"+e.widgetId+"/?"+n}function n(t){var o=t.data;try{o=JSON.parse(o)}catch(t){o=null}null!==o&&"object"==typeof o&&o.token===c&&(i.hasOwnProperty(o.action)?i[o.action](o.data):console.log('неверный "action" '+o.action))}function r(t,o){t.forEach(function(t){if(null===o[t]||void 0===o[t])throw new Error('"'+t+'" is required')})}if(t===t.top){var i={changeWidgetHeight:function(t){l.height=t.value},scrollToWidget:function(e){var n=Math.max(o.body.scrollTop,o.documentElement.scrollTop),r=l.getBoundingClientRect().top+n;t.scrollTo(0,r+(e.offset||0))},scrollToWidgetCenter:function(){i.scrollToWidget({offset:l.clientHeight/2-t.innerHeight/2})}},a=[],c=btoa(Math.random().toString()),d={init:function(i,c,s){if(!f){if("string"==typeof i)try{i=JSON.parse(i)}catch(t){i=null}if(null===i||"object"!=typeof i)throw new Error('Invalid parameter "data". Object type expected');r(["partnerId","server","type","widgetId"],i),r(["textColor","bgColor","buttonColor","h1Color","h2Color"],i);var p=o.createElement("iframe");p.frameBorder=0,p.scrolling="no",p.onload=function(){u=!0,a.forEach(function(t){t()})}.bind(null,p),p.width="100%",p.height=0,p.src=e(i),f=!0,l=p,function(t,e){e.parentNode===o.head?"loading"!==o.readyState?o.body.appendChild(t):o.addEventListener("DOMContentLoaded",function(){o.body.appendChild(t)}):e.parentNode.insertBefore(t,e)}(p,s||d._target),t.addEventListener("message",n),d.ready(c)}},ready:function(t){"function"==typeof t&&(u?setTimeout(t,0):a.push(t))},sendAction:function(t,o){d.ready(function(){var e={action:t,token:c,data:o};l.contentWindow.postMessage(JSON.stringify(e),"*")})}},l=null,f=!1,u=!1;return d}console.log("наш скрипт вставили внутрь другого айфейма")}(window,document);
