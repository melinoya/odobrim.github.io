var _odobrimWidget=function(r,a){"use strict";function i(e,t){if(t.parentNode===a.head){if(a.readyState!=="loading"){a.body.appendChild(e)}else{a.addEventListener("DOMContentLoaded",function(){a.body.appendChild(e)})}}else{t.parentNode.insertBefore(e,t)}}function c(){g=true;t.forEach(function(e){e()})}function o(){var t;try{t=r.top.location.href}catch(e){if(a.domain!==""){var n=r.location.protocol;t=(n==="data:"?"http://":n)+a.domain}else{t=r.location.href}}return t}function d(e){var t=new URLSearchParams;for(var n in e){if(e.hasOwnProperty(n)){t.append(n,e[n])}}t.append("location",o());t.append("token",s);return"//"+e.server+"/widget/"+e.widgetId+"/?"+t}function l(e){var t=e.data;try{t=JSON.parse(t)}catch(e){t=null}if(t!==null&&typeof t==="object"&&t.token===s){if(n.hasOwnProperty(t.action)){n[t.action](t.data)}else{console.log('неверный "action" '+t.action)}}}function f(e,t){e.forEach(function(e){if(t[e]===null||t[e]===void 0){throw new Error('"'+e+'" is required')}})}if(r!==r.top){console.log("наш скрипт вставили внутрь другого айфейма");return}var n={changeWidgetHeight:function(e){p.height=e.value},scrollToWidget:function(e){var t=Math.max(a.body.scrollTop,a.documentElement.scrollTop);var n=p.getBoundingClientRect().top+t;r.scrollTo(0,n+(e.offset||0))},scrollToWidgetCenter:function(){n.scrollToWidget({offset:p.clientHeight/2-r.innerHeight/2})}};var t=[];var s=btoa(Math.random().toString());var u={init:function(t,e,n){if(!h){if(typeof t==="string"){try{t=JSON.parse(t)}catch(e){t=null}}if(t===null||typeof t!=="object"){throw new Error('Invalid parameter "data". Object type expected')}f(["partnerId","server","type","widgetId"],t);var o=a.createElement("iframe");o.frameBorder=0;o.scrolling="no";o.onload=c.bind(null,o);o.width="100%";o.height=0;o.src=d(t);h=true;p=o;i(o,n||u._target);r.addEventListener("message",l);u.ready(e)}},ready:function(e){if(typeof e!=="function"){return}if(g){setTimeout(e,0)}else{t.push(e)}},sendAction:function e(t,n){u.ready(function(){var e={action:t,token:s,data:n};p.contentWindow.postMessage(JSON.stringify(e),"*")})}};var p=null;var h=false;var g=false;return u}(window,document);